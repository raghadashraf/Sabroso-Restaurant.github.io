<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- STYLESHEETS -->
    <link rel="stylesheet" href="CSS/Reservation.css" />
    <link rel="stylesheet" href="CSS/home.css" />

    <title> Book A Table</title>
  </head>
  <body>
    <header>
      <a href="#">
        <img src="Images/logof.png" alt="Logo" class="logo"></a>
          <nav class="navigation">
              <a href="home.html">Home</a>
              <a href="MainMenu.html">Menu</a>
              <a href="feedback.html">Contact</a>
              <a href="about.html">About</a>
              <a href="myprofile.html">My Profile</a>
          </nav>
    </header>
    <section class="page restaurant">
      <div class="page-image">
        <img src="https://www.franciscosegarra.com/wp-content/uploads/2020/07/mobilier-pour-restaurants-chics-1-1024x768.jpg" alt="img" />
      </div>

      <div class="page-content">
        <section>
          <h2>Reservation</h2>

          <form id="reservationForm">
            <div class="input-group">
              <label for="name">Name</label>
              <input type="text" id="name" />
            </div>

            <div class="input-group">
              <label for="email">Email</label>
              <input type="email" id="email" />
            </div>

            <div class="input-row flex">
              <div class="input-group">
                <label for="date">Date</label>
                <input type="date" id="date" />
              </div>

              <div class="input-group">
                <label for="time">Time</label>
                <input type="time" id="time" />
              </div>
              <div class="input-group">
                        <label for="person">Number of Person</label>
                        <input type="number" id="person" />
                      </div>
            </div>

            <button id="bookTableButton" class="form-btn" type="submit">BOOK A TABLE</button>
          </form>
        </section>
      </div>
    </section>
    
    <script>
        // Function to save reservation data to local storage and profile table
        function saveReservation() {
            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const date = document.getElementById("date").value;
            const time = document.getElementById("time").value;
            const person = document.getElementById("person").value;

            const reservation = {
                name: name,
                email: email,
                date: date,
                time: time,
                person: person
            };

            // Save reservation to local storage
            let reservations = JSON.parse(localStorage.getItem("reservations")) || [];
            reservations.push(reservation);
            localStorage.setItem("reservations", JSON.stringify(reservations));

            // Add reservation to profile table
            const profileTable = document.getElementById("reservationTable").getElementsByTagName('tbody')[0];
            const newRow = profileTable.insertRow(-1); // Insert new row at the end of the table
            const cell1 = newRow.insertCell(0); // Insert cells
            const cell2 = newRow.insertCell(1);
            const cell3 = newRow.insertCell(2);
            const cell4 = newRow.insertCell(3);
            const cell5 = newRow.insertCell(4);
            const cell6 = newRow.insertCell(5);
            cell1.innerHTML = name; // Add data to cells
            cell2.innerHTML = email;
            cell3.innerHTML = date;
            cell4.innerHTML = time;
            cell5.innerHTML = person;
            cell6.innerHTML = '<button class="cancel-btn" onclick="cancelReservation(this)">Cancel</button>'; // Add cancel button
        }

        // Event listener for form submission
        document.getElementById("reservationForm").addEventListener("submit", function(event) {
            event.preventDefault(); // Prevent form submission
            saveReservation(); // Save reservation data
            // window.location.href = "myprofile.html"; // No need to redirect as the user is already on the profile page
        });

        // Function to cancel a reservation
        function cancelReservation(btn) {
            // Get the row to be removed
            var row = btn.closest("tr");
            // Remove the row from the table
            row.remove();
            // TODO: Add code to remove reservation from storage
        }
    </script>
  </body>
</html>
